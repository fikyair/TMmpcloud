<!--miniprogram/pages/detailTasks/detailTasks.wxml-->
<view wx:if='{{hasFather==true}}'>
        <navigator
            url="../detailTasks/detailTasks?id={{fatherTasks[0]._id}}"
            open-type="redirect"
            >
            <view class="cu-list menu list-menu">
                <view class="cu-item">
                        <text class='icon-stop text-sm'></text>
                        <text class='text-grey text-sm'>{{fatherTasks[0].task_name}}</text>
                </view>
            </view>
        </navigator>
</view>

<view wx:elif="{{hasFather==false}}">
    
</view>

<form bindsubmit="formSubmitDetail">
<view class='cu-card case bg-white padding'>
  <view class=' flex justify-between'>
    <view class='flex justify-start'>
        <view class='flex justify-start'>
            <text class='icon-my margin-xs'></text>
            <view class="user-avatar sm" bindtap='inviteFriends' wx:if='{{filterList.task_person==null}}'>
                <view class='cu-avatar round sm text-grey' style='background-image: url(https://image.weilanwl.com/img/square-1.jpg)' />
            </view>
            <view class="user-avatar sm" bindtap='inviteFriends' wx:else >
                <view class='cu-avatar round sm text-grey' style='background-image: url({{filterList.task_personavater}})' />
            </view>
        </view>

        <view class='flex justify-start' style="margin-left: 10rpx;">
            <text class='icon-calendar margin-xs'></text>
            <picker
                mode="date"
                value="{{task_date}}"
                bindchange="bindDateChange"
                style="margin-left: 10rpx;"
            >
                <view class="picker text-xl text-black">
                    {{task_date?task_date:'截止日期'}}
                </view>
            </picker>
        </view>
    </view>
  </view>


  <view class='flex justify-start' style="margin-top: 10rpx;">
        <text class='icon-roundcheck margin-xs'></text>
        <input placeholder="任务名称" class='radius text-xl text-black' style="margin-top: 8rpx; margin-left: 10rpx;" name='task_name' value='{{filterList.task_name}}'></input>
  </view>
    
    <view class="cu-form-group bg-white light radius margin-xs"  style='border:0.5px solid #E0E6E9'>
        <input placeholder="描述一下吧" class='radius text-xl text-black' name='task_details' value='{{filterList.task_details}}'></input>
    </view>
</view>

<!-- 判断子任务 -->
<view wx:if='{{hasSon==true}}'>
            <navigator
            url="../detailTasks/detailTasks?id={{item._id}}"
            open-type="redirect"
            wx:for="{{sonTasks}}"
		    wx:for-index="idx"
		    wx:for-item="item"
            >
                <view class="cu-list menu list-menu">
                    <view class="cu-item arrow">
                        <button class='cu-btn content' bindtap=''>
                            <text class='icon-notice text-sm'></text>
                            <text class='text-m text-black'>{{item.task_name}}</text>
                            <text class='text-m'>({{item.son_Tasks_Count?item.son_Tasks_Count:"0"}})</text>
                        </button>
                    </view>
                </view>
   </navigator>
</view>

<view wx:if='{{hasSon==false}}'></view>

<!-- 进度条-->
 <view class="cu-list ">
        <view class="cu-item" style="padding: 0 7rpx;">
            <view class='content padding-tb-sm'>
                 <view>
                    <text class='icon-titles text-green text-xl'> 任务进度(%)</text>
                </view>
            </view>
        </view>
</view>
<view wx:if='{{haSonTag===false}}'class="cu-list menu margin-lg">
        <view class="section section_gap card-menu ">
            <view class="body-view">
                <input placeholder="请填写进度" class='radius text-xl text-black' name='task_progress' value='{{filterList.task_progress*100}}'></input>
            </view>
        </view>
</view>
<view wx:else='{{haSonTag===true}}' class=" menu margin-lg">
         <wux-progress background-color="#f3f3f3" percent="{{ filterList.task_progress*100 }}"/>
         {{filterList.task_progress*100}}%
</view>

    <view wx:if='{{haSonTag===false}}'class="foot flex flex-direction" style="bottom: 0; position: fixed; z-index: 1024; width: 100%;">
        <view class="grid col-3 ">
            <button class=' cu-btn bg-grey lg '  style='border-radius: 0; width: 33%;' bindtap='addSonTasks'>添加子任务</button>
            <button class=' cu-btn bg-grey lg'  style='border-radius: 0; width: 33%;' form-type="submit">完成</button>
            <button class=' cu-btn bg-grey lg' style='border-radius: 0; width: 34%;' bindtap='deleteTasks'>删除任务</button>
        </view>
    </view>
    <view wx:else class="foot flex flex-direction" style="bottom: 0; position: fixed; z-index: 1024; width: 100%;">
        <view >
            <button class=' cu-btn bg-grey lg '  style='border-radius: 0; width: 50%;' bindtap='addSonTasks'>添加子任务</button>
            <button class=' cu-btn bg-grey lg'  style='border-radius: 0; width: 50%;' form-type="submit">完成</button>
        </view>
    </view>
</form>

<view class="cu-modal {{closeModalShow?'show':''}}">
		<view class='cu-dialog'>
			<view class='cu-bar bg-white justify-end'>
				<view class='content'>添加子任务</view>
				<view class='action'>
				    <text class='icon-close Text-red' bindtap='addTaskX'/>
                </view>
			</view>
			<form bindsubmit="formSubmitSonTask">
                <input placeholder="子任务名称" class='radius' name='task_name' value='{{valueSonTasksInput}}'></input>
				<view class='cu-bar bg-white justify-end'>
					<view class='action'>
						<button class='cu-btn line-green text-green' bindtap='addTaskCancel'>取消</button>
						<button class='cu-btn bg-green margin-left' form-type="submit">确定</button>
					</view>
				</view>
			</form>
		</view>
</view>

<view class="cu-modal {{inviteModal?'show':''}}">
  <view class="cu-dialog">
    <view class="cu-bar bg-white justify-end">
      <view class='content'>提示</view>
      <view class='action' bindtap='hideInviteModal'>
        <text class='icon-close text-red'></text>
      </view>
    </view>
    <view class='padding-0'>
      <button open-type='share' class='text-black bg-white' bindtap='inviteFriendBtn'>邀请微信好友</button>
    </view>
  </view>
</view>